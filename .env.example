# Cherwell Cycle Agent Environment Configuration
# Copy this file to .env and fill in values

# =============================================================================
# REQUIRED - Anthropic API (Phase 4)
# =============================================================================
ANTHROPIC_API_KEY=sk-ant-...
CLAUDE_MODEL=claude-sonnet-4-5-20250929

# Model for classification tasks (document filtering, query generation, verification)
DOCUMENT_FILTER_MODEL=claude-haiku-4-5-20251001

# =============================================================================
# API Configuration
# =============================================================================
# Comma-separated list of valid API keys
API_KEYS=sk-cycle-dev-key-1,sk-cycle-dev-key-2

# Rate limit: requests per minute per API key
API_RATE_LIMIT=60

# =============================================================================
# Redis
# =============================================================================
REDIS_URL=redis://redis:6379/0

# =============================================================================
# Worker
# =============================================================================
# Number of worker container replicas
WORKER_REPLICAS=1

# Data directories (inside containers)
CHROMA_PERSIST_DIR=/data/chroma
RAW_DOCS_DIR=/data/raw
OUTPUT_DIR=/data/output
POLICY_DOCS_DIR=/data/policy

# Embedding model for sentence-transformers
EMBEDDING_MODEL=all-MiniLM-L6-v2

# =============================================================================
# Scraper
# =============================================================================
# Seconds between requests to Cherwell portal
SCRAPER_RATE_LIMIT=1.0

# User-Agent header for scraping requests
SCRAPER_USER_AGENT=CherwellCycleReview/1.0 (cycling-advocacy-tool)

# =============================================================================
# Webhooks
# =============================================================================
# Global webhook URL â€” all events are sent here. Leave empty to disable.
# Events: review.completed, review.completed.markdown, review.failed, letter.completed
#WEBHOOK_URL=http://localhost:3000/api/webhooks/planning

# Timeout for webhook delivery attempts (seconds)
WEBHOOK_TIMEOUT=10

# Maximum retry attempts for failed webhooks
WEBHOOK_MAX_RETRIES=5

# =============================================================================
# MCP Server Authentication (optional)
# =============================================================================
# Bearer token for authenticating external MCP server connections (n8n, Claude Desktop).
# When set, all MCP servers require Authorization: Bearer <token>.
# Leave empty for no auth (default for local development).
#MCP_API_KEY=

# =============================================================================
# S3-Compatible Storage (optional)
# =============================================================================
# When S3_ENDPOINT_URL is set, downloaded documents are uploaded to S3 and
# URLs in reviews point to the S3 bucket. Local temp files are cleaned up
# after ingestion. Review and letter outputs are also uploaded to S3.
# When not set, all storage uses local Docker volumes (existing behaviour).

# S3_ENDPOINT_URL=https://nyc3.digitaloceanspaces.com
# S3_BUCKET=my-planning-bucket
# S3_ACCESS_KEY_ID=DO00...
# S3_SECRET_ACCESS_KEY=...
# S3_KEY_PREFIX=planning
# S3_REGION=nyc3

# =============================================================================
# General
# =============================================================================
LOG_LEVEL=INFO

# How long to keep review results in Redis (days)
REVIEW_RESULT_TTL_DAYS=30
